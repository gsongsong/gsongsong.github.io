<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>Jeon, an engineer</title>
  <meta name="author" content="Seokseong Jeon">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="Jeon, an engineer"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Jeon, an engineer</a></h1>
  <h2><a href="/">Write the unwritten</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/about">About</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a target="_blank" rel="noopener" href="https://github.com/gsongsong/hexo-src/issues/new">âœ’</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article id="post-axios-with-proxy-and-custom-ssl-certificate" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-08-26T14:13:12.000Z"><a href="/2021/08/26/axios-with-proxy-and-custom-ssl-certificate/">2021-08-26</a></time>
      
      
  
    <h1 class="title"><a href="/2021/08/26/axios-with-proxy-and-custom-ssl-certificate/">axios with proxy and custom SSL certificate</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>This article summarizes what made me struggle days.</p>
<h1><span id="fix-https-proxy-agent-to-support-ca">Fix <code>https-proxy-agent</code> to support CA</span></h1><p>It was originally proposed <a target="_blank" rel="noopener" href="https://github.com/TooTallNate/node-https-proxy-agent/issues/89#issuecomment-688353505">here</a> by <a target="_blank" rel="noopener" href="https://github.com/maslakov">maslakov</a>.</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpsProxyAgent, HttpsProxyAgentOptions &#125; <span class="keyword">from</span> <span class="string">&#x27;https-proxy-agent&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; ClientRequest, RequestOptions &#125; <span class="keyword">from</span> <span class="string">&#x27;agent-base&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Socket &#125; <span class="keyword">from</span> <span class="string">&#x27;net&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">PatchedHttpsProxyAgent</span> <span class="keyword">extends</span> <span class="title">HttpsProxyAgent</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> ca: <span class="built_in">any</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="title">constructor</span>(<span class="params">opts: HttpsProxyAgentOptions</span>)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>(opts);</span><br><span class="line">    <span class="built_in">this</span>.ca = opts.ca;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">async</span> callback(req: ClientRequest, <span class="attr">opts</span>: RequestOptions): <span class="built_in">Promise</span>&lt;Socket&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">super</span>.callback(req, <span class="built_in">Object</span>.assign(opts, &#123; <span class="attr">ca</span>: <span class="built_in">this</span>.ca &#125;));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1><span id="working-prototype">Working prototype</span></h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> HttpsProxyAgent = <span class="built_in">require</span>(<span class="string">&#x27;https-proxy-agent&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ca = <span class="built_in">require</span>(<span class="string">&#x27;ssl-root-cas/latest&#x27;</span>).create();</span><br><span class="line"></span><br><span class="line">ca.addFile(certificateFilePath);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> httpsAgent = <span class="keyword">new</span> HttpsProxyAgent(&#123;</span><br><span class="line">  <span class="attr">protocol</span>: <span class="string">&#x27;http&#x27;</span>,</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;proxy_host&#x27;</span>,</span><br><span class="line">  <span class="attr">port</span>: <span class="number">8080</span>,</span><br><span class="line">  ca,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">axios.defaults.httpsAgent = httpsAgent;</span><br></pre></td></tr></table></figure>

<h1><span id="references">References</span></h1><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/TooTallNate/node-https-proxy-agent/issues/89#issuecomment-688353505">PatchedHttpsProxyAgent</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-nr-rrc-changes-on-june-2021" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-07-29T11:07:24.000Z"><a href="/2021/07/29/nr-rrc-changes-on-june-2021/">2021-07-29</a></time>
      
      
  
    <h1 class="title"><a href="/2021/07/29/nr-rrc-changes-on-june-2021/">NR RRC changes on June 2021</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>Some interesting changes</p>
<!-- toc -->

<ul>
<li><a href="#r2-2106555-nr-dc-cell-group-capability-filtering">R2-2106555 NR-DC Cell Group capability filtering</a></li>
<li><a href="#r2-2106712-correction-to-ca-parametersnr-fordc">R2-2106712 Correction to ca-ParametersNR-ForDC</a></li>
<li><a href="#r2-2106754-clarification-on-the-timing-reference-of-pscell-smtc-configuration">R2-2106754 Clarification on the Timing Reference of PSCell SMTC Configuration</a></li>
<li><a href="#r2-2105462-clarification-on-scellfrequencies">R2-2105462 Clarification on SCellFrequencies</a></li>
</ul>
<!-- tocstop -->

<h2><span id="r2-2106555-nr-dc-cell-group-capability-filtering">R2-2106555 NR-DC Cell Group capability filtering</span></h2><p>This CR <a target="_blank" rel="noopener" href="https://www.3gpp.org/ftp/TSG_RAN/WG2_RL2/TSGR2_114-e/Docs/R2-2106555.zip">R2-2106555</a> introduces <em>cell grouping</em> in UE capability enquiry for NR-DC. In Release 15, NR-DC is limited to FR1 MCG and FR2 SCG. But from Releae 16, this limitation is removed. It introduces ambiguity that which MCG and SCG configuration UE supports. To remove the ambiguity, the network can enquiry UE with <code>CellGrouping</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">UE-CapabilityRequestFilterCommon ::=            SEQUENCE &#123;</span><br><span class="line">    -- Omitted</span><br><span class="line">    [[</span><br><span class="line">    requestedCellGrouping-r16      SEQUENCE (SIZE (1..maxCellGroupings-r16)) OF CellGrouping-r16    OPTIONAL    -- Cond NRDC</span><br><span class="line">    ]]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">CellGrouping-r16 ::     SEQUENCE &#123;</span><br><span class="line">    mcg-r16                 SEQUENCE (SIZE (1..maxBands)) OF FreqBandIndicatorNR,</span><br><span class="line">    scg-r16                 SEQUENCE (SIZE (1..maxBands)) OF FreqBandIndicatorNR,</span><br><span class="line">    mode-r16                ENUMERATED &#123;sync, async&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For example, the network can enquiry UE with the following cell grouping filter:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123; mcg: [1, 2, 3], scg: [256, 257], mode:  sync &#125;,</span><br><span class="line">&#123; mcg: [1, 2, 3], scg: [256, 257], mode: async &#125;,</span><br><span class="line">&#123; mcg: [1, 2, 3], scg: [ 66,  77], mode:  sync &#125;,</span><br></pre></td></tr></table></figure>

<p>UE receiving the filter, it reports supported band combinations with <code>supportedCellGrouping</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CA-ParametersNRDC-v16xy ::=                     SEQUENCE &#123;</span><br><span class="line">    supportedCellGrouping-r16                         BIT STRING (SIZE (1..maxCellGroupings-r16))        OPTIONAL</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If the first bit of a bit string is set to 1, a given band combination supports NR-DC with the first cell grouping configuration.</p>
<h2><span id="r2-2106712-correction-to-ca-parametersnr-fordc">R2-2106712 Correction to ca-ParametersNR-ForDC</span></h2><p>I believe the main point of this CR <a target="_blank" rel="noopener" href="https://www.3gpp.org/ftp/TSG_RAN/WG2_RL2/TSGR2_114-e/Docs/R2-2106712.zip">R2-2106712</a> is to clarify that <code>ca-ParametersNR[-ForDC[-vABCD]]</code> applies separately.  I doubt that it is less likely to be misunderstood, but at the same time, I believe it is good to refine the statement.</p>
<blockquote>
<p><strong>ca-ParametersNR-forDC (with and without suffix)</strong><br>If this field is present for a band combination, it reports the UE capabilities when NR-DC is configured with the band combination. If <del>no</del> <ins>a</ins> version of this field (i.e., with <del>and</del> <ins>or</ins> without suffix) is <del>present</del> <ins>absent</ins> for a band combination, the <ins>corresponding</ins> ca-ParametersNR field versions <del>(with and without suffix)</del> in BandCombination <del>are</del> <ins>is</ins> applicable to the UE configured with NR-DC for the band combination. <ins>If a version of this field (i.e., with or without suffix) is present for a band combination but does not contain any parameters, the UE does not support the corresponding field version when configured with NR-DC for the band combination.</ins></p>
</blockquote>
<h2><span id="r2-2106754-clarification-on-the-timing-reference-of-pscell-smtc-configuration">R2-2106754 Clarification on the Timing Reference of PSCell SMTC Configuration</span></h2><p><code>targetCellSMTC-SCG</code> was originally introduced as name <code>smtc</code> in last September, but renamed for more clarity in the next RAN Plenary. It is useful when MCG and SCG have different timing reference. This CR <a target="_blank" rel="noopener" href="https://www.3gpp.org/ftp/TSG_RAN/WG2_RL2/TSGR2_114-e/Docs/R2-2106754.zip">R2-2106754</a> clarifies how UE applies SMTC in a MCG mobility case.</p>
<h2><span id="r2-2105462-clarification-on-scellfrequencies">R2-2105462 Clarification on SCellFrequencies</span></h2><p>It was a bug in the specification that ASN.1 structure and description of its interpretation. According to the below structure <code>scellFrequencies</code> can be absent:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CG-Config-v1590-IEs ::= SEQUENCE &#123;</span><br><span class="line">    scellFrequenciesSN-NR       SEQUENCE (SIZE (1.. maxNrofServingCells-1)) OF ARFCN-ValueNR       OPTIONAL,</span><br><span class="line">    scellFrequenciesSN-EUTRA    SEQUENCE (SIZE (1.. maxNrofServingCells-1)) OF ARFCN-ValueEUTRA    OPTIONAL,</span><br><span class="line">    nonCriticalExtension        CG-Config-v1610-IEs                                                OPTIONAL</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>However, the below statement specifies that the receiving node shall maintain the previous configuration:</p>
<blockquote>
<p>As an exception to this general rule, the absence of the below listed fields means that a receiving node maintains the values informed via the previous message.<br>(Omitted)</p>
<ul>
<li>scellFrequenciesSN-EUTRA;</li>
<li>scellFrequenciesSN-NR.</li>
</ul>
</blockquote>
<p>Comparing the structure and the statement, an obvious inconsistency exists that a sending node may omit the IE if no SCell exists. So this CR <a target="_blank" rel="noopener" href="https://www.3gpp.org/ftp/TSG_RAN/WG2_RL2/TSGR2_114-e/Docs/R2-2105462.zip">R2-2105462</a> removes two IEs from the statement so that the receiving node shall overwrite the previous configuration with the new one.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-building-github-action-to-publish-hexo-post-from-github-issue" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-07-28T11:20:45.000Z"><a href="/2021/07/28/building-github-action-to-publish-hexo-post-from-github-issue/">2021-07-28</a></time>
      
      
  
    <h1 class="title"><a href="/2021/07/28/building-github-action-to-publish-hexo-post-from-github-issue/">Building GitHub Action to publish Hexo post from GitHub Issue</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>I wanted to write and publish a Hexo post without tedious commands such as <code>git clone</code>, <code>git pull</code>, <code>hexo new</code>, <code>hexo generate</code>, <code>git commit</code> and <code>git push</code>. I saw the feasibility to build an automated publishing system using GitHub Issue and GitHub Actions for this purpose.</p>
<p>Hereâ€™s workflow what I thought:</p>
<ul>
<li>A user makes an issue, a draft of a post on GitHub Issue</li>
<li>GitHub Workflow is triggered against the issue</li>
<li>The workflow converts the issue to a Hexo post</li>
</ul>
<p><strong>GitHub Issue</strong></p>
<p>I thought that GitHub Issue is a perfect system to draft a post. It has a title, a content and a date/time of update and those information can be a title, a content and a date/time of a post. One thing missing is tags of a post. To achieve this, I got an idea to use labels of an issue as tags of a post.</p>
<p><strong>GitHub Action</strong></p>
<p>I did a research whether there exists GitHub Actions converting an issue to a Hexo post, but I found nothing. So I decided to build a GitHub Action for it.</p>
<p>First of all, it takes two parameters, <code>issue_url</code> and <code>token</code> and extracts <code>endpoint</code> from <code>issue_url</code>:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> core <span class="keyword">from</span> <span class="string">&#x27;@actions/core&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> issueUrl = core.getInput(<span class="string">&#x27;issue_url&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> index = issueUrl.indexOf(<span class="string">&#x27;/repos&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> endpoint = issueUrl.substring(index);</span><br><span class="line"><span class="keyword">const</span> token = core.getInput(<span class="string">&#x27;token&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>And then, it initializes Hexo:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Hexo <span class="keyword">from</span> <span class="string">&#x27;hexo&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> hexo = <span class="keyword">new</span> Hexo(process.cwd(), &#123;&#125;);</span><br><span class="line">hexo.init().then(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Described below</span></span><br><span class="line">&#125;).catch(<span class="function">(<span class="params">reason</span>) =&gt;</span> &#123;</span><br><span class="line">    core.setFailed(reason);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>After Hexo is initialized, it retrieves information of an issue:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Octokit &#125; <span class="keyword">from</span> <span class="string">&#x27;octokit&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// After resolving `hexo.init()`</span></span><br><span class="line"><span class="keyword">const</span> gh = <span class="keyword">new</span> Octokit(&#123; <span class="attr">auth</span>: token &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`Converting issue <span class="subst">$&#123;endpoint&#125;</span> to Hexo post...`</span>);</span><br><span class="line">gh.request(<span class="string">`GET <span class="subst">$&#123;endpoint&#125;</span>`</span>).then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; title, <span class="attr">updated_at</span>: date, labels, milestone, <span class="attr">body</span>: content &#125; = response.data;</span><br><span class="line">    <span class="comment">// Described below</span></span><br><span class="line">&#125;).catch(<span class="function">(<span class="params">reason</span>) =&gt;</span> &#123;</span><br><span class="line">    core.setFailed(reason);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>If a draft is set to be published, it derives tags and creates a Hexo post:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MILESTONE_PUBLISH = <span class="string">&#x27;publish&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (milestone.title !== MILESTONE_PUBLISH) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`Issue does not have milestone <span class="subst">$&#123;MILESTONE_PUBLISH&#125;</span>`</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> tags = labels.map(<span class="function">(<span class="params">label: <span class="built_in">any</span></span>) =&gt;</span> label.name);</span><br><span class="line">    hexo.post.create(&#123;</span><br><span class="line">        title,</span><br><span class="line">        date,</span><br><span class="line">        tags,</span><br><span class="line">        content,</span><br><span class="line">    &#125; <span class="keyword">as</span> <span class="built_in">any</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>At this point, a markdown file is generated and further actions to be prepared to complete publishing a post. The complete implementation of this action can be found <a target="_blank" rel="noopener" href="https://github.com/gsongsong/issue-to-hexo">here</a>.</p>
<p><strong>Workflow</strong></p>
<p>Now a complete workflow needs to be setup. The workflow below converts an issue to a post and pushes it to the repository:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Issue</span> <span class="string">to</span> <span class="string">Hexo</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">issues:</span></span><br><span class="line">    <span class="comment"># Sufficient to trigger this workflow when an issue is milestoned</span></span><br><span class="line">    <span class="attr">types:</span> [ <span class="string">milestoned</span> ]</span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">persist-credentials:</span> <span class="string">&#x27;false&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">gsongsong/issue-to-hexo@v1.0.0</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">issue_url:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.event.issue.url</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="comment"># Personal access token used to get information of Issue</span></span><br><span class="line">          <span class="attr">token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.token</span> <span class="string">&#125;&#125;</span></span><br><span class="line">      <span class="comment"># At this point, a markdown file is generated and untracked</span></span><br><span class="line">      <span class="comment"># Take further action, e.g. generate (`hexo generate`), commit and push</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Commit</span> <span class="string">post</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git add .</span></span><br><span class="line"><span class="string">          git config user.name &quot;issue-to-hexo bot&quot;</span></span><br><span class="line"><span class="string">          git config.user.email &quot;&lt;&gt;&quot;</span></span><br><span class="line"><span class="string">          git commit -m &quot;Add a post&quot;</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Push</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">ad-m/github-push-action@master</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.token</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<p>I have another workflow which generates (<code>hexo generate</code>) a blog from the pushed code. I made two separate workflows because I both use GitHub Issue to draft a post and manually write and push a markdown draft on my PC. Hereâ€™s the workflow:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Publish</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">master</span> ]</span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">persist-credentials:</span> <span class="string">&#x27;false&#x27;</span></span><br><span class="line">          <span class="attr">submodules:</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/setup-node@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&#x27;14&#x27;</span></span><br><span class="line">      <span class="comment"># This submodule is a directory that contains generated Hexo blog</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">submodule</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd public</span></span><br><span class="line"><span class="string">          git checkout master</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          npm install</span></span><br><span class="line"><span class="string">          npm run build</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Commit</span> <span class="string">submodule</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd public</span></span><br><span class="line"><span class="string">          git add .</span></span><br><span class="line"><span class="string">          git config user.name &quot;gsongsong/hexo-src bot&quot;</span></span><br><span class="line"><span class="string">          git config user.email &quot;&lt;&gt;&quot;</span></span><br><span class="line"><span class="string">          git commit -m &quot;Publish&quot;</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Push</span> <span class="string">submodule</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">ad-m/github-push-action@master</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">github_token:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.token</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">directory:</span> <span class="string">&#x27;public&#x27;</span></span><br><span class="line">          <span class="attr">repository:</span> <span class="string">&#x27;gsongsong/gsongsong.github.io&#x27;</span></span><br><span class="line">      <span class="comment"># These actions commits and pushes the submodule to the main module</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Commit</span> <span class="string">main</span> <span class="string">module</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          git add .</span></span><br><span class="line"><span class="string">          git config user.name &quot;gsongsong/hexo-src bot&quot;</span></span><br><span class="line"><span class="string">          git config user.email &quot;&lt;&gt;&quot;</span></span><br><span class="line"><span class="string">          git commit -m &quot;Publish&quot;</span></span><br><span class="line"><span class="string"></span>      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Push</span> <span class="string">main</span> <span class="string">module</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">ad-m/github-push-action@master</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-drag-sorting-ant-design-table-with-dnd-kit" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-07-16T00:00:00.000Z"><a href="/2021/07/16/drag-sorting-ant-design-table-with-dnd-kit/">2021-07-16</a></time>
      
      
  
    <h1 class="title"><a href="/2021/07/16/drag-sorting-ant-design-table-with-dnd-kit/">Drag sorting Ant Design Table with dnd kit</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <!-- toc -->

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#prepare-dummy-data">Prepare dummy data</a></li>
<li><a href="#define-a-state-variable-for-drag-overlay">Define a state variable for drag overlay</a></li>
<li><a href="#convert-table-into-sortable-preset-of-dnd-kit">Convert <code>Table</code> into sortable preset of dnd kit</a></li>
<li><a href="#draggablewrapper">DraggableWrapper</a></li>
<li><a href="#draggablerow">DraggableRow</a></li>
<li><a href="#handledragstart">handleDragStart</a></li>
<li><a href="#handledragend">handleDragEnd</a></li>
</ul>
<!-- tocstop -->

<h2><span id="introduction">Introduction</span></h2><p>I was trying to implement <a target="_blank" rel="noopener" href="https://ant.design/components/table/#components-table-demo-drag-sorting-handler">Drag sorting with handler</a> for Ant Design Table. I found that <a target="_blank" rel="noopener" href="https://github.com/clauderic/react-sortable-hoc">react-sortable-hoc</a> is not going to be enhancement further and the author encourages to use <a target="_blank" rel="noopener" href="https://github.com/clauderic/dnd-kit">dnd kit</a>. This article summarizes what I did to implement  it with dnd kit.</p>
<h2><span id="prepare-dummy-data">Prepare dummy data</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function App() &#123;</span><br><span class="line">  const columns = [</span><br><span class="line">    &#123;</span><br><span class="line">      key: &quot;dragHandle&quot;, dataIndex: &quot;dragHandle&quot;, title: &quot;Drag&quot;,</span><br><span class="line">      width: 30,</span><br><span class="line">      render: () =&gt; &lt;MenuOutlined /&gt;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      key: &quot;key&quot;, dataIndex: &quot;key&quot;, title: &quot;Key&quot;,</span><br><span class="line">    &#125;,</span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  const dataSourceRaw = new Array(5).fill(&#123;&#125;).map((item, index) =&gt; (&#123;</span><br><span class="line">    // This will be transformed into `data-row-key` of props.</span><br><span class="line">    // Shall be truthy to be draggable. I don&#x27;t know why.</span><br><span class="line">    // To this end, index of number type is converted into string.</span><br><span class="line">    key: index.toString(),</span><br><span class="line">  &#125;));</span><br><span class="line">  const [dataSource, setDataSource] = useState(dataSourceRaw);</span><br><span class="line"></span><br><span class="line">  return (</span><br><span class="line">    &lt;Table</span><br><span class="line">      columns=&#123;columns&#125;</span><br><span class="line">      dataSource=&#123;dataSource&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">  );</span><br></pre></td></tr></table></figure>

<p>The important thing here is that the <span style="background-color: #ff0;"><strong>key used to identify an item must be truthy value.</strong></span> I struggled with a situation that the first item is not draggable. After some minutes of debugging, I found that if the key is falsy value, it is not draggable. But I couldnâ€™t find the root cause for this.</p>
<h2><span id="define-a-state-variable-for-drag-overlay">Define a state variable for drag overlay</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// ID to render overlay.</span><br><span class="line">const [activeId, setActiveId] = useState(null);</span><br></pre></td></tr></table></figure>

<p><code>activeId</code> will be used for determining whether to render drag overlay or not.</p>
<h2><span id="convert-table-into-sortable-preset-of-dnd-kit">Convert <code>Table</code> into sortable preset of dnd kit</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">const sensors = useSensors(</span><br><span class="line">  useSensor(PointerSensor),</span><br><span class="line">  useSensor(KeyboardSensor, &#123;</span><br><span class="line">    coordinateGetter: sortableKeyboardCoordinates,</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">return (</span><br><span class="line">  &lt;DndContext</span><br><span class="line">    sensors=&#123;sensors&#125;</span><br><span class="line">    collisionDetection=&#123;closestCenter&#125;</span><br><span class="line">    onDragEnd=&#123;handleDragEnd&#125;</span><br><span class="line">  &gt;</span><br><span class="line">    &lt;Table</span><br><span class="line">      columns=&#123;columns&#125;</span><br><span class="line">      dataSource=&#123;dataSource&#125;</span><br><span class="line">      components=&#123;&#123;</span><br><span class="line">        body: &#123;</span><br><span class="line">          wrapper: DraggableWrapper,</span><br><span class="line">          row: DraggableRow,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">    &#123;/* Render overlay component. */&#125;</span><br><span class="line">    &lt;DragOverlay&gt;&#123;activeId ? activeId : null&#125;&lt;/DragOverlay&gt;</span><br><span class="line">  &lt;/DndContext&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>According to <a target="_blank" rel="noopener" href="https://docs.dndkit.com/presets/sortable#single-container">sortable single container</a>, enclose <code>Table</code> in <code>DndContext</code>, wrap body (<code>tbody</code>) with <code>SortableContext</code> and implement <code>useSortable</code> in row (<code>tr</code>). In this example, <code>DraggableWrapper</code> implements <code>SortableContext</code> and <code>DraggableRow</code> implements <code>tr</code> with <code>useSortrable</code>.</p>
<p><code>DragOverlay</code> is rendered only when <code>activeId</code> has a valid ID value.</p>
<h2><span id="draggablewrapper">DraggableWrapper</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function DraggableWrapper(props: any) &#123;</span><br><span class="line">  const &#123; children, ...restProps &#125; = props;</span><br><span class="line">  return (</span><br><span class="line">    &lt;SortableContext</span><br><span class="line">      // `children[1]` is `dataSource`.</span><br><span class="line">      // This will be transformed into `data-row-key` of props</span><br><span class="line">      items=&#123;children[1].map((child: any) =&gt; child.key)&#125;</span><br><span class="line">      strategy=&#123;verticalListSortingStrategy&#125;</span><br><span class="line">      &#123;...restProps&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;tbody &#123;...restProps&#125;&gt;</span><br><span class="line">        &#123;</span><br><span class="line">          // This invokes `Table.components.body.row` for each element of `children`.</span><br><span class="line">          children</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;/tbody&gt;</span><br><span class="line">    &lt;/SortableContext&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>DraggableWrapper</code> implements <code>SortableContext</code>. <code>items</code> shall be a list of keys to identify items, not items themselves. Inside <code>tbody</code>, <code>children</code> is a list of rows and each item will invoke <code>Table.components.body.row</code>, which is <code>DraggableRow</code>.</p>
<h2><span id="draggablerow">DraggableRow</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">function DraggableRow(props: any) &#123;</span><br><span class="line">  const &#123; attributes, listeners, setNodeRef &#125; = useSortable(&#123;</span><br><span class="line">    id: props[&quot;data-row-key&quot;],</span><br><span class="line">  &#125;);</span><br><span class="line">  const &#123; children, ...restProps &#125; = props;</span><br><span class="line">  return (</span><br><span class="line">    &lt;tr ref=&#123;setNodeRef&#125; &#123;...attributes&#125; &#123;...restProps&#125;&gt;</span><br><span class="line">      &#123;</span><br><span class="line">        children.map((child: any) =&gt; &#123;</span><br><span class="line">          const &#123; children, key, ...restProps &#125; = child;</span><br><span class="line">          return key === &#x27;dragHandle&#x27; ? (</span><br><span class="line">            &lt;td &#123;...listeners&#125; &#123;...restProps&#125;&gt;</span><br><span class="line">              &#123;child&#125;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">          ) : (</span><br><span class="line">            &lt;td &#123;...restProps&#125;&gt;</span><br><span class="line">              &#123;child&#125;</span><br><span class="line">            &lt;/td&gt;</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>DraggableRow</code> implements <code>tr</code> with <code>useSortable</code>, where <code>id</code> must be the same with a <code>key</code> of each item. We want to make a row draggable, so assign <code>setNodRef</code> to <code>tr</code>. And we want to enable dragging only when a user grabs a drag handle, so assign <code>listeners</code> to <code>td</code> containing a drag handle.</p>
<h2><span id="handledragstart">handleDragStart</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function handleDragStart(event: any) &#123;</span><br><span class="line">  const &#123; active &#125; = event;</span><br><span class="line">  setActiveId(active.id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2><span id="handledragend">handleDragEnd</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function handleDragEnd(event: any) &#123;</span><br><span class="line">  const &#123; active, over &#125; = event;</span><br><span class="line">  if (active.id !== over.id) &#123;</span><br><span class="line">    setDataSource((items) =&gt; &#123;</span><br><span class="line">      // In this example, find an item, where `item.key` === `useSortable.id`.</span><br><span class="line">      const oldIndex = items.findIndex((item) =&gt; item.key === active.id);</span><br><span class="line">      const newIndex = items.findIndex((item) =&gt; item.key === over.id);</span><br><span class="line">      return arrayMove(items, oldIndex, newIndex);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  // Stop overlay.</span><br><span class="line">  setActiveId(null);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>handleDragEnd</code> performs swapping two items. Here, to find indexes of two items in data source, we need to compare <code>key</code> of an item and <code>id</code> of <code>useSortable</code>. </p>
<p>You can find demo <a target="_blank" rel="noopener" href="https://codesandbox.io/s/frosty-mahavira-i17ph">here</a>.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-finding-the-number-of-edges-of-a-document" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-06-03T00:00:00.000Z"><a href="/2021/06/03/finding-the-number-of-edges-of-a-document/">2021-06-03</a></time>
      
      
  
    <h1 class="title"><a href="/2021/06/03/finding-the-number-of-edges-of-a-document/">Finding the number of edges of a document in ArangoDB</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2><span id="query">Query</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FOR d, e IN ANY|INBOUND|OUTBOUND documentId edgeCollectionName</span><br><span class="line">  COLLECT AGGREGATE numEdges = LENGTH(1)</span><br><span class="line">  RETURN numEdges</span><br></pre></td></tr></table></figure>

<h2><span id="application-finding-a-document-with-no-edge">Application: Finding a document with no edge</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FOR doc IN collectionName</span><br><span class="line">  let numEdges = (</span><br><span class="line">    FOR d, e IN ANY|INBOUND|OUTBOUND doc._id edgeCollectionName</span><br><span class="line">      COLLECT AGGREGATE numEdges = LENGTH(1)</span><br><span class="line">      RETURN numEdges</span><br><span class="line">  )[0]</span><br><span class="line">  FILTER numEdges == 0</span><br><span class="line">  RETURN doc</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-finding-an-item-in-an-array-with-partial-match" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-05-08T00:00:00.000Z"><a href="/2021/05/08/finding-an-item-in-an-array-with-partial-match/">2021-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2021/05/08/finding-an-item-in-an-array-with-partial-match/">Finding an item in an array with partial match in ArangoDB</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <h2><span id="query">Query</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LET needle = &quot;eedl&quot;</span><br><span class="line">LET haystack = [&quot;needle&quot;, &quot;in&quot;, &quot;a&quot;, &quot;haystack&quot;]</span><br><span class="line">RETURN haystack[** FILTER CONTAINS(CURRENT, needle)]</span><br><span class="line">// Output: [&quot;needle&quot;]</span><br></pre></td></tr></table></figure>

<h2><span id="variant-case-insensitive">Variant: Case-insensitive</span></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LET needle = &quot;EEDL&quot;</span><br><span class="line">LET haystack = [&quot;needle&quot;, &quot;in&quot;, &quot;a&quot;, &quot;haystack&quot;]</span><br><span class="line">RETURN haystack[** FILTER CONTAINS(LOWER(CURRENT), LOWER(needle))]</span><br><span class="line">// Output: [&quot;needle&quot;]</span><br></pre></td></tr></table></figure>

<h2><span id="references">References</span></h2><ol>
<li><a target="_blank" rel="noopener" href="https://www.arangodb.com/docs/stable/aql/advanced-array-operators.html#inline-filter">Array operators - Inline filter</a></li>
<li><a target="_blank" rel="noopener" href="https://www.arangodb.com/docs/stable/aql/functions-string.html#contains">String functions - CONTAINS()</a></li>
<li><a target="_blank" rel="noopener" href="https://www.arangodb.com/docs/stable/aql/functions-string.html#lower">String functions - LOWER()</a></li>
</ol>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-uml-and-openapi-for-full-stack-development" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2021-03-14T00:00:00.000Z"><a href="/2021/03/14/uml-and-openapi-for-full-stack-development/">2021-03-14</a></time>
      
      
  
    <h1 class="title"><a href="/2021/03/14/uml-and-openapi-for-full-stack-development/">UML and OpenAPI for full stack development</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>There are many good articles introducing how to become a full stack developer.  Lots of technologies â€” HTML, CSS, JavaScript, Express, React are mentioned. They are really good resources. However, I think they miss some importatnt things and here are two importatnt things.</p>
<h2><span id="uml-data-model-of-service">UML: Data Model of Service</span></h2><p>Before implementing a service, it is important to construct concrete a data model, definitions and relationships between entities. Without a concrete data model, design and implementation of service are highly likely to be changed during development, resulting in an unstable product and risk of missing feature.</p>
<p>To design a class diagram, you can use one of software (or others):</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://staruml.io/">StarUML</a></li>
<li><a target="_blank" rel="noopener" href="https://www.diagrams.net/">diagrams.net</a></li>
<li><a target="_blank" rel="noopener" href="https://plantuml.com/">PlantUML</a></li>
<li><a target="_blank" rel="noopener" href="https://www.lucidchart.com/pages/">Lucidchart</a></li>
</ul>
<h2><span id="openapi-protocol-between-backend-and-frontend">OpenAPI: Protocol between Backend and Frontend</span></h2><p>After designing data model, a developer needs to implement backend service provider and frontend service request. <a target="_blank" rel="noopener" href="http://spec.openapis.org/oas/v3.1.0">OpenAPI</a> enables a developer to define a protocol: which paths, parameters and body contents to use, how responses will be.</p>
<p>To design OpenAPI, you can use one of software (or others):</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://insomnia.rest/product/design">Insomnia Designer</a></li>
<li><a target="_blank" rel="noopener" href="https://redoc.ly/">Redocly</a></li>
<li><a target="_blank" rel="noopener" href="https://www.postman.com/">Postman</a></li>
<li><a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=42Crunch.vscode-openapi">OpenAPI (Swagger) Editor (VSCode Extension)</a></li>
<li><a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=Arjun.swagger-viewer">Swagger Viewer (VSCode Extension)</a></li>
<li><a target="_blank" rel="noopener" href="https://swagger.io/">Swagger</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-embedding-worker-in-electron-app-using-webpack-and-electron-builder" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2020-09-22T00:00:00.000Z"><a href="/2020/09/22/embedding-worker-in-electron-app-using-webpack-and-electron-builder/">2020-09-22</a></time>
      
      
  
    <h1 class="title"><a href="/2020/09/22/embedding-worker-in-electron-app-using-webpack-and-electron-builder/">Embedding worker in Electron app using Webpack and electron-builder</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><em>Disclaimer: as per electron-boilerplate</em></p>
<p>Make webpack bundle your worker code. Iâ€™ll skip the <a target="_blank" rel="noopener" href="https://gist.github.com/gsongsong/02b93857e83b770554017c0566510371">entire code</a> here because itâ€™s too long.</p>
<p>Remeber the output path</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: path.join(__dirname, <span class="string">&#x27;..&#x27;</span>),</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;./app/dist/worker.js&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Make electron-builder copy your worker bundle file .</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;build&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;files&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;dist/&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This will place your worker bunlde file <em>inside</em> <code>resources/app.asar</code>.</p>
<p>Adjust worker path and working directory for <code>fork</code> in <code>main.dev.ts</code>.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> workerPath =</span><br><span class="line">  process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span></span><br><span class="line">    ? <span class="string">&#x27;app/worker.js&#x27;</span></span><br><span class="line">    : <span class="string">&#x27;app.asar/dist/worker.js&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> workerCwd =</span><br><span class="line">  process.env.NODE_ENV === <span class="string">&#x27;development&#x27;</span></span><br><span class="line">    ? <span class="literal">undefined</span></span><br><span class="line">    : join(__dirname, <span class="string">&#x27;..&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> worker = fork(workerPath, &#123; <span class="attr">cwd</span>: workerCwd &#125;);</span><br></pre></td></tr></table></figure>

<h2><span id="references">References</span></h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/electron/electron/issues/2708">Cannot child_process.fork() when inside ASAR #2708</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-installing-electron-manually-for-electron-builder" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2020-08-11T00:00:00.000Z"><a href="/2020/08/11/installing-electron-manually-for-electron-builder/">2020-08-11</a></time>
      
      
  
    <h1 class="title"><a href="/2020/08/11/installing-electron-manually-for-electron-builder/">Installing Electron manually for electron-builder</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>This article tries to resolve an uncommon issue when you encounter the following error and it cannot be resolved automatically, e.g. behind proxy, etc.:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Electron failed to install correctly, please delete node_modules/electron and try installing again</span><br></pre></td></tr></table></figure>

<p>Download the right version (with consideration of <code>package.json</code>) of Electron from <a target="_blank" rel="noopener" href="https://github.com/electron/electron/releases">https://github.com/electron/electron/releases</a></p>
<p>Unpack the downloaded Electron and put all files under <code>node_modules/electron/dist</code>.</p>
<p>Create <code>path.txt</code> file under <code>node_modules/electron</code> with the following content:</p>
<ul>
<li>Windows: <code>electron.exe</code></li>
<li>Linux: <code>electron</code></li>
<li>macOS: <code>Electron.app/Contents/MacOS/Electron</code></li>
</ul>
<p><em>Note: Make sure there is no whitespace characters (including a newline character) after the filename. This is a problem that I struggled for minutes and hours.</em></p>
<h2><span id="references">References</span></h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/electron/electron-rebuild/issues/39">spawn dist/electron.exe ENOENT #39</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article id="post-quick-start-on-antlr4-in-rust-part3" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2020-06-10T00:00:00.000Z"><a href="/2020/06/10/quick-start-on-antlr4-in-rust-part3/">2020-06-10</a></time>
      
      
  
    <h1 class="title"><a href="/2020/06/10/quick-start-on-antlr4-in-rust-part3/">Quick start on ANTLR4 in Rust - part3</a></h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p><em>This is my note in adopting and learning ANTLR4Rust</em></p>
<p><strong>Series</strong></p>
<ul>
<li><a href="/2020/05/29/quick-start-on-antlr4-in-rust-part1">Quick Start on ANTLR4 in Rust â€” Part1</a></li>
<li><a href="/2020/06/02/quick-start-on-antlr4-in-rust-part2">Quick Start on ANTLR4 in Rust â€” Part2</a></li>
<li>Quick Start on ANTLR4 in Rust â€” Part3 (This article)</li>
</ul>
<hr>
<p>In the previous article, we implemented a parser with internal state variables. However, if a grammar is huge, it is practically impossible to manage a huge number of state variables. Alternatively, a visitor-like approach can be used.</p>
<p>In an exit method of the root rule in the Listener, we can grab the current context and its children and call custom parser methods:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">impl</span> Listener &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">hdr</span></span>(&amp;<span class="keyword">self</span>, ctx: &amp;HdrContextAll) -&gt; Row &#123;</span><br><span class="line">        <span class="keyword">let</span> row_ctx = ctx.row().unwrap();</span><br><span class="line">        <span class="keyword">self</span>.row(&amp;row_ctx)</span><br><span class="line">    &#125;    <span class="function"><span class="keyword">fn</span> <span class="title">row</span></span>(&amp;<span class="keyword">self</span>, ctx: &amp;RowContextAll) -&gt; Row &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut</span> row = Row::new();</span><br><span class="line">        <span class="keyword">let</span> field_ctx_list = ctx.field_all();</span><br><span class="line">        <span class="keyword">for</span> (_i, field_ctx) <span class="keyword">in</span> field_ctx_list.iter().enumerate() &#123;</span><br><span class="line">            <span class="keyword">let</span> field = <span class="keyword">self</span>.field(&amp;field_ctx);</span><br><span class="line">            row.push(field);</span><br><span class="line">        &#125;</span><br><span class="line">        row</span><br><span class="line">    &#125;    <span class="function"><span class="keyword">fn</span> <span class="title">field</span></span>(&amp;<span class="keyword">self</span>, ctx: &amp;FieldContextAll) -&gt; <span class="built_in">String</span> &#123;</span><br><span class="line">        ctx.get_text()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> CSVListener <span class="keyword">for</span> Listener &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fn</span> <span class="title">exit_csvFile</span></span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>, ctx: &amp;CsvFileContext) &#123;</span><br><span class="line">        <span class="keyword">let</span> hdr_ctx = ctx.hdr().unwrap();</span><br><span class="line">        <span class="keyword">let</span> header = <span class="keyword">self</span>.hdr(&amp;hdr_ctx);</span><br><span class="line">        <span class="keyword">self</span>.csv.header = header;</span><br><span class="line">        <span class="keyword">let</span> row_ctx_list = ctx.row_all();</span><br><span class="line">        <span class="keyword">for</span> (_i, row_ctx) <span class="keyword">in</span> row_ctx_list.iter().enumerate() &#123;</span><br><span class="line">            <span class="keyword">let</span> row = <span class="keyword">self</span>.row(&amp;row_ctx);</span><br><span class="line">            <span class="keyword">self</span>.csv.rows.push(row);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The minimal working example can be found <a target="_blank" rel="noopener" href="https://github.com/gsongsong/antlr4rust_quickstart/commit/541cd68c7587e62263242df5a2998a5e9dff71ce">here</a>.</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>






<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="as_sitesearch" value="jeon.engineer">
  </form>
</div>


  

  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/3gpp/">3GPP</a><small>1</small></li>
  
    <li><a href="/tags/antlr4/">ANTLR4</a><small>3</small></li>
  
    <li><a href="/tags/amazon/">Amazon</a><small>1</small></li>
  
    <li><a href="/tags/ant-design/">Ant Design</a><small>1</small></li>
  
    <li><a href="/tags/arangodb/">ArangoDB</a><small>2</small></li>
  
    <li><a href="/tags/dw1000/">DW1000</a><small>1</small></li>
  
    <li><a href="/tags/dwm1000/">DWM1000</a><small>1</small></li>
  
    <li><a href="/tags/decawave/">DecaWave</a><small>2</small></li>
  
    <li><a href="/tags/evk1000/">EVK1000</a><small>1</small></li>
  
    <li><a href="/tags/electron/">Electron</a><small>2</small></li>
  
    <li><a href="/tags/git/">Git</a><small>1</small></li>
  
    <li><a href="/tags/github-action/">GitHub Action</a><small>1</small></li>
  
    <li><a href="/tags/hexo/">Hexo</a><small>1</small></li>
  
    <li><a href="/tags/intel/">Intel</a><small>1</small></li>
  
    <li><a href="/tags/nr/">NR</a><small>1</small></li>
  
    <li><a href="/tags/nr-dc/">NR-DC</a><small>1</small></li>
  
    <li><a href="/tags/openapi/">OpenAPI</a><small>1</small></li>
  
    <li><a href="/tags/rrc/">RRC</a><small>1</small></li>
  
    <li><a href="/tags/react/">React</a><small>1</small></li>
  
    <li><a href="/tags/rust/">Rust</a><small>3</small></li>
  
    <li><a href="/tags/ssl-certificate/">SSL certificate</a><small>1</small></li>
  
    <li><a href="/tags/trek1000/">TREK1000</a><small>1</small></li>
  
    <li><a href="/tags/thrift/">Thrift</a><small>1</small></li>
  
    <li><a href="/tags/uml/">UML</a><small>1</small></li>
  
    <li><a href="/tags/uwb/">UWB</a><small>2</small></li>
  
    <li><a href="/tags/wi-fi/">Wi-Fi</a><small>1</small></li>
  
    <li><a href="/tags/axios/">axios</a><small>1</small></li>
  
    <li><a href="/tags/dnd-kit/">dnd kit</a><small>1</small></li>
  
    <li><a href="/tags/dual-connectivity/">dual connectivity</a><small>1</small></li>
  
    <li><a href="/tags/email/">email</a><small>1</small></li>
  
    <li><a href="/tags/optimization/">optimization</a><small>1</small></li>
  
    <li><a href="/tags/positioning/">positioning</a><small>3</small></li>
  
    <li><a href="/tags/privacy/">privacy</a><small>1</small></li>
  
    <li><a href="/tags/proxy/">proxy</a><small>1</small></li>
  
    <li><a href="/tags/telecommunications/">telecommunications</a><small>1</small></li>
  
    <li><a href="/tags/trilateration/">trilateration</a><small>2</small></li>
  
    <li><a href="/tags/web-font/">web font</a><small>1</small></li>
  
    <li><a href="/tags/webpack/">webpack</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2021 Seokseong Jeon
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script>
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
